![](./../../../assets/images/banner_xmas.png)



    	
            
# cat_clicker



## Challenge Author(s):
`yakuhito`

## Description:
```
Ever wanted to rescue cats in a game very similar to cookie clicker? If the answer is yes, then Cat Clicker is the perfect game for you!
```

## Target:

`http://challs.xmas.htsp.ro:3003/`

## Objective:

Get *13 cats* (limit is *12 cats*) bypassing the `hash (MD5) check` in order to "buy" the flag (flag cost is 13 cats).

## Difficulty/Points: 
`hard/474`

## Flag:
`X-MAS{1_h4v3_s0_m4ny_c4t5_th4t_my_h0m3_c4n_b3_c0ns1d3r3d_4_c4t_sh3lt3r_aaf30fcb4319effa}`
# 


# Challenge
The challenge allows you to get *cats* by clicking on the *"Budinca image"*, up to a maximum of 12 cats. Then these *cats* can be used to buy in the *shop*, both *Fake Flag (1 cat)*, and the *Real Flag (TEH FLAGGGG!) (13 cats)*.

![Image of cat_cliker_page](images/cat_clicker_page.png)
![not_enough cats](images/not_enough.png)

When we try to buy something, inside the *HTTP POST request* sent to `/api/buy.php` , a *hash value* previously generated by the web application backend is inserted in it (read function `buy(item_id)` in *script.js*)... This hash value can be read by going to the browser's Javascript console and typing `window.token`. In addition to the hash value, a *state* *"12 | 0"* is also fixed , which represents *"<limit_cats> | <own_cats>*" (`window.state`).

![window_token](images/window_token.png)
![burp_request](images/burp_buy.png)

# Solution


